<VirtualHost *:80>
    ServerName a2elbm2.com
    ServerAlias www.a2elbm2.com

    # Préservation du host original
    ProxyPreserveHost On

    # Redirection du trafic vers ton backend local sur le port 8336
    ProxyPass / http://localhost:8336/
    ProxyPassReverse / http://localhost:8336/

    # En-têtes utiles pour Django
    RequestHeader set X-Forwarded-For expr=%{REMOTE_ADDR}
    RequestHeader set X-Forwarded-Proto expr=%{REQUEST_SCHEME}

    # Gestion des fichiers statiques et médias
    Alias /static /home/a2elbm2_website/static
    Alias /media  /home/a2elbm2_website/media

    <Directory "/home/a2elbm2_website/static">
        Require all granted
    </Directory>

    <Directory "/home/a2elbm2_website/media">
        Require all granted
    </Directory>

    # Logs du site
    ErrorLog ${APACHE_LOG_DIR}/a2elbm2_error.log
    CustomLog ${APACHE_LOG_DIR}/a2elbm2_access.log combined

    # Redirection vers HTTPS
    RewriteEngine On
    RewriteCond %{SERVER_NAME} =a2elbm2.com [OR]
    RewriteCond %{SERVER_NAME} =www.a2elbm2.com
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
